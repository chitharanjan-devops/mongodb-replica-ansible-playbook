---
- hosts: all
  become: true
  tasks:
    - name: Stop MongoDB service
      service:
        name: mongod
        state: stopped

    - name: Configure mongod.conf for replication
      blockinfile:
        path: /etc/mongod.conf
        marker: ""
        block: |
          net:
            bindIp: 0.0.0.0
            port: 27017
          replication:
            replSetName: "rs0"
      notify:
        - Restart MongoDB

    - name: Start MongoDB service
      service:
        name: mongod
        state: started

  handlers:
    - name: Restart MongoDB
      service:
        name: mongod
        state: restarted
